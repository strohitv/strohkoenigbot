{
  "databaseChangeLog": [
    {
      "changeSet": {
        "id": "1",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "configuration",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "config_name",
                    "type": "varchar(50)"
                  }
                },
                {
                  "column": {
                    "name": "config_value",
                    "type": "varchar(5000)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_login",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "nickname",
                    "type": "varchar(50)"
                  }
                },
                {
                  "column": {
                    "name": "cookie",
                    "type": "varchar(500)"
                  }
                },
                {
                  "column": {
                    "name": "expires_at",
                    "type": "timestamp"
                  }
                },
                {
                  "column": {
                    "name": "session_token",
                    "type": "varchar(500)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "twitch_auth",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "token",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "channel_id",
                    "type": "varchar(30)"
                  }
                },
                {
                  "column": {
                    "name": "username",
                    "type": "varchar(30)"
                  }
                },
                {
                  "column": {
                    "name": "is_main",
                    "type": "boolean"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "ability_notification",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "user_id",
                    "type": "varchar(40)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "gear",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "main",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "favored",
                    "type": "varchar(40)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "discord_account",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "twitch_user_id",
                    "type": "varchar(40)",
                    "constraints": {
                      "nullable": false,
                      "unique": true
                    }
                  }
                },
                {
                  "column": {
                    "name": "discord_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "consent",
                    "type": "boolean"
                  }
                }
              ]
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "user_id",
              "baseTableName": "ability_notification",
              "constraintName": "fk_twitch_user_id",
              "onDelete": "CASCADE",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "twitch_user_id",
              "referencedTableName": "discord_account",
              "validate": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "2",
        "author": "strohkoenig",
        "changes": [
          {
            "dropForeignKeyConstraint": {
              "baseTableName": "ability_notification",
              "constraintName": "fk_twitch_user_id"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "discord_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "ability_notification"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "discord_id",
                    "valueComputed": "(SELECT dc.id FROM DBO.discord_account dc WHERE dc.twitch_user_id = user_id)"
                  }
                }
              ],
              "tableName": "ability_notification"
            }
          },
          {
            "delete": {
              "tableName": "ability_notification",
              "where": "discord_id IS NULL"
            }
          },
          {
            "dropColumn": {
              "columnName": "user_id",
              "tableName": "ability_notification"
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "discord_id",
              "baseTableName": "ability_notification",
              "constraintName": "fk_discord_id",
              "onDelete": "CASCADE",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "id",
              "referencedTableName": "discord_account",
              "validate": true
            }
          },
          {
            "dropNotNullConstraint": {
              "columnDataType": "varchar(40)",
              "columnName": "twitch_user_id",
              "tableName": "discord_account"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "3",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_stage",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(50)"
                  }
                },
                {
                  "column": {
                    "name": "image",
                    "type": "varchar(80)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_rotation",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "splatoon_api_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "start_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "end_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "stage_a_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "stage_b_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "mode",
                    "type": "varchar(30)"
                  }
                },
                {
                  "column": {
                    "name": "rule",
                    "type": "varchar(30)"
                  }
                }
              ]
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "stage_a_id",
              "baseTableName": "splatoon_rotation",
              "constraintName": "fk_splatoon_rotation_stage_a_id",
              "onDelete": "RESTRICT",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "id",
              "referencedTableName": "splatoon_stage",
              "validate": true
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "stage_b_id",
              "baseTableName": "splatoon_rotation",
              "constraintName": "fk_splatoon_rotation_stage_b_id",
              "onDelete": "RESTRICT",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "id",
              "referencedTableName": "splatoon_stage",
              "validate": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "4",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_weapon",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(50)"
                  }
                },
                {
                  "column": {
                    "name": "image",
                    "type": "varchar(80)"
                  }
                },
                {
                  "column": {
                    "name": "sub_splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "sub_name",
                    "type": "varchar(20)"
                  }
                },
                {
                  "column": {
                    "name": "sub_image",
                    "type": "varchar(80)"
                  }
                },
                {
                  "column": {
                    "name": "special_splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "special_name",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "special_image",
                    "type": "varchar(80)"
                  }
                },
                {
                  "column": {
                    "name": "turf",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "wins",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_monthly_result",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "period_year",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "period_month",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "start_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "end_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "zones_current",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "zones_peak",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "zones_weapon_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_zones_monthly_weapon_id",
                      "references": "splatoon_weapon(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_current",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_peak",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_weapon_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_rainmaker_monthly_weapon_id",
                      "references": "splatoon_weapon(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "tower_current",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "tower_peak",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "tower_weapon_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_tower_monthly_weapon_id",
                      "references": "splatoon_weapon(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "clams_current",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "clams_peak",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "clams_weapon_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_clams_monthly_weapon_id",
                      "references": "splatoon_weapon(id)"
                    }
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "5",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_gear",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "kind",
                    "type": "varchar(15)"
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "image",
                    "type": "varchar(80)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_ability",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "splatoon_api_id",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "name",
                    "type": "varchar(40)"
                  }
                },
                {
                  "column": {
                    "name": "image",
                    "type": "varchar(80)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_match",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "battle_number",
                    "type": "varchar(6)"
                  }
                },
                {
                  "column": {
                    "name": "start_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "elapsed_time",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "rotation_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_match_rotation_id",
                      "references": "splatoon_rotation(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "stage_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": false,
                      "foreignKeyName": "fk_match_stage_id",
                      "references": "splatoon_stage(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "mode",
                    "type": "varchar(30)"
                  }
                },
                {
                  "column": {
                    "name": "rule",
                    "type": "varchar(30)"
                  }
                },
                {
                  "column": {
                    "name": "rank",
                    "type": "varchar(3)"
                  }
                },
                {
                  "column": {
                    "name": "x_power",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "x_power_estimate",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "x_lobby_power",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "league_tag",
                    "type": "varchar(20)"
                  }
                },
                {
                  "column": {
                    "name": "league_power",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "league_power_max",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "league_power_estimate",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "league_enemy_power",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "weapon_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_match_weapon_id",
                      "references": "splatoon_weapon(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "turf_gain",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "turf_total",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "kills",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "assist",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "deaths",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "specials",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "own_score",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "own_percentage",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "enemy_score",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "enemy_percentage",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "match_result",
                    "type": "varchar(10)"
                  }
                },
                {
                  "column": {
                    "name": "is_ko",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "headgear_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_match_headgear_id",
                      "references": "splatoon_gear(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "clothes_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_match_clothes_id",
                      "references": "splatoon_gear(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "shoes_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_match_shoes_id",
                      "references": "splatoon_gear(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "json_overview",
                    "type": "clob(15000)"
                  }
                },
                {
                  "column": {
                    "name": "json_match",
                    "type": "clob(100000)"
                  }
                }
              ]
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_ability_match",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "ability_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_ability_match_ability_id",
                      "references": "splatoon_ability(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "match_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": true,
                      "foreignKeyName": "fk_ability_match_match_id",
                      "references": "splatoon_match(id)"
                    }
                  }
                },
                {
                  "column": {
                    "name": "kind",
                    "type": "varchar(15)"
                  }
                },
                {
                  "column": {
                    "name": "gear_position",
                    "type": "int"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "6",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "defeats",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_weapon"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "zones_wins",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "zones_defeats",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "rainmaker_wins",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "rainmaker_defeats",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "tower_wins",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "tower_defeats",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "clams_wins",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "clams_defeats",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_stage"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "7",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_clips",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "start_time",
                    "type": "timestamp"
                  }
                },
                {
                  "column": {
                    "name": "end_time",
                    "type": "timestamp"
                  }
                },
                {
                  "column": {
                    "name": "is_good_play",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "clip_url",
                    "type": "varchar(150)"
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "varchar(500)"
                  }
                },
                {
                  "column": {
                    "name": "match_id",
                    "type": "bigint"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "8",
        "author": "strohkoenig",
        "changes": [
          {
            "columns": [
              {
                "column": {
                  "name": "main",
                  "value": "Last-Ditch Effort"
                }
              }
            ],
            "tableName": "ability_notification",
            "where": "main='Last Ditch Effort'"
          },
          {
            "columns": [
              {
                "column": {
                  "name": "main",
                  "value": "Bomb Defense Up DX"
                }
              }
            ],
            "tableName": "ability_notification",
            "where": "main='Bomb Defense Up Dx'"
          },
          {
            "columns": [
              {
                "column": {
                  "name": "favored",
                  "value": "Bomb Defense Up DX"
                }
              }
            ],
            "tableName": "ability_notification",
            "where": "favored='Bomb Defense Up Dx'"
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "9",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "splatnet_battle_number",
                    "position": 2,
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_match"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "10",
        "author": "strohkoenig",
        "changes": [
          {
            "createIndex": {
              "clustered": true,
              "columns": [
                {
                  "column": {
                    "descending": true,
                    "name": "battle_number"
                  }
                }
              ],
              "indexName": "splatnet_battle_number",
              "tableName": "splatoon_match",
              "unique": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "11",
        "author": "strohkoenig",
        "changes": [
          {
            "createIndex": {
              "clustered": false,
              "columns": [
                {
                  "column": {
                    "descending": true,
                    "name": "battle_number"
                  }
                }
              ],
              "indexName": "splatnet_battle_number",
              "tableName": "splatoon_match",
              "unique": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "12",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "twitch_so_account",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "username",
                    "type": "varchar(150)"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "13",
        "author": "strohkoenig",
        "changes": [
          {
            "dropColumn": {
              "tableName": "splatoon_login",
              "columns": [
                {
                  "column": {
                    "name": "nickname"
                  }
                },
                {
                  "column": {
                    "name": "session_token"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "14",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_weapon_request_ranking",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "twitch_id",
                    "type": "varchar(150)"
                  }
                },
                {
                  "column": {
                    "name": "twitch_name",
                    "type": "varchar(150)"
                  }
                },
                {
                  "column": {
                    "name": "win_streak",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "weapon_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "challenged_at",
                    "type": "timestamp"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "15",
        "author": "strohkoenig",
        "changes": [
          {
            "delete": {
              "tableName": "twitch_auth",
              "where": "is_main='true'"
            }
          },
          {
            "dropColumn": {
              "tableName": "twitch_auth",
              "columns": [
                {
                  "column": {
                    "name": "channel_id"
                  }
                },
                {
                  "column": {
                    "name": "username"
                  }
                },
                {
                  "column": {
                    "name": "is_main"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "15-fix",
        "author": "strohkoenig",
        "preConditions": [
          {
            "onFail": "MARK_RAN",
            "not": {
              "changeSetExecuted": {
                "id": "16",
                "author": "strohkoenig",
                "changelog-file": "db.changelog-master.json"
              }
            }
          }
        ],
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_clip",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "16",
        "author": "strohkoenig",
        "changes": [
          {
            "dropTable": {
              "tableName": "splatoon_clip"
            }
          },
          {
            "dropTable": {
              "tableName": "splatoon_clips"
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_clip",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "start_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "end_time",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "is_good_play",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "clip_url",
                    "type": "varchar(150)"
                  }
                },
                {
                  "column": {
                    "name": "description",
                    "type": "varchar(500)"
                  }
                },
                {
                  "column": {
                    "name": "match_id",
                    "type": "bigint"
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "17",
        "author": "strohkoenig",
        "changes": [
          {
            "renameTable": {
              "oldTableName": "splatoon_ability",
              "newTableName": "splatoon_2_ability"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_ability_match",
              "newTableName": "splatoon_2_ability_match"
            }
          },
          {
            "renameTable": {
              "oldTableName": "ability_notification",
              "newTableName": "splatoon_2_ability_notification"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_clip",
              "newTableName": "splatoon_2_clip"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_gear",
              "newTableName": "splatoon_2_gear"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_login",
              "newTableName": "splatoon_2_login"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_match",
              "newTableName": "splatoon_2_match"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_monthly_result",
              "newTableName": "splatoon_2_monthly_result"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_rotation",
              "newTableName": "splatoon_2_rotation"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_stage",
              "newTableName": "splatoon_2_stage"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_weapon",
              "newTableName": "splatoon_2_weapon"
            }
          },
          {
            "renameTable": {
              "oldTableName": "splatoon_weapon_request_ranking",
              "newTableName": "splatoon_2_weapon_request_ranking"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "18",
        "author": "strohkoenig",
        "changes": [
          {
            "renameTable": {
              "oldTableName": "discord_account",
              "newTableName": "account"
            }
          },
          {
            "dropColumn": {
              "tableName": "account",
              "columns": [
                {
                  "column": {
                    "name": "consent"
                  }
                }
              ]
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "splatoon_cookie",
                    "type": "varchar(500)"
                  }
                },
                {
                  "column": {
                    "name": "splatoon_cookie_expires_at",
                    "type": "timestamp"
                  }
                },
                {
                  "column": {
                    "name": "is_main_account",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "timezone",
                    "type": "varchar(75)"
                  }
                },
                {
                  "column": {
                    "name": "should_send_daily_stats",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "current_step",
                    "type": "int"
                  }
                }
              ],
              "tableName": "account"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "splatoon_cookie",
                    "valueComputed": "(select b.cookie from DBO.splatoon_2_login b)"
                  }
                },
                {
                  "column": {
                    "name": "splatoon_cookie_expires_at",
                    "valueComputed": "(select b.expires_at from DBO.splatoon_2_login b)"
                  }
                },
                {
                  "column": {
                    "name": "is_main_account",
                    "valueBoolean": "true"
                  }
                }
              ],
              "tableName": "account",
              "where": "discord_id = 256536949756657664"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "is_main_account",
                    "valueBoolean": "false"
                  }
                }
              ],
              "tableName": "account",
              "where": "discord_id != 256536949756657664"
            }
          },
          {
            "dropTable": {
              "tableName": "splatoon_2_login"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "19",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_2_stage_stats",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "stage_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "account_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "zones_wins",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "zones_defeats",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_wins",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_defeats",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "tower_wins",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "tower_defeats",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "clams_wins",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "clams_defeats",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "sql": {
              "sql": "INSERT INTO DBO.splatoon_2_stage_stats (stage_id, zones_wins, zones_defeats, rainmaker_wins, rainmaker_defeats, tower_wins, tower_defeats, clams_wins, clams_defeats) SELECT b.id, b.zones_wins, b.zones_defeats, b.rainmaker_wins, b.rainmaker_defeats, b.tower_wins, b.tower_defeats, b.clams_wins, b.clams_defeats FROM DBO.splatoon_2_stage b"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_stage_stats"
            }
          },
          {
            "createTable": {
              "tableName": "splatoon_2_weapon_stats",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "weapon_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "account_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "turf",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "wins",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "defeats",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "sql": {
              "sql": "INSERT INTO DBO.splatoon_2_weapon_stats (weapon_id, turf, wins, defeats) SELECT b.id, b.turf, b.wins, b.defeats FROM DBO.splatoon_2_weapon b"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_weapon_stats"
            }
          },
          {
            "dropColumn": {
              "columns": [
                {
                  "column": {
                    "name": "zones_wins"
                  }
                },
                {
                  "column": {
                    "name": "zones_defeats"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_wins"
                  }
                },
                {
                  "column": {
                    "name": "rainmaker_defeats"
                  }
                },
                {
                  "column": {
                    "name": "tower_wins"
                  }
                },
                {
                  "column": {
                    "name": "tower_defeats"
                  }
                },
                {
                  "column": {
                    "name": "clams_wins"
                  }
                },
                {
                  "column": {
                    "name": "clams_defeats"
                  }
                }
              ],
              "tableName": "splatoon_2_stage"
            }
          },
          {
            "dropColumn": {
              "columns": [
                {
                  "column": {
                    "name": "turf"
                  }
                },
                {
                  "column": {
                    "name": "wins"
                  }
                },
                {
                  "column": {
                    "name": "defeats"
                  }
                }
              ],
              "tableName": "splatoon_2_weapon"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "splatoon_2_clip"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "splatoon_2_monthly_result"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "splatoon_2_weapon_request_ranking"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "position": 2,
                    "type": "bigint"
                  }
                }
              ],
              "tableName": "twitch_so_account"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_clip"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_monthly_result"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "splatoon_2_weapon_request_ranking"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "account_id",
                    "valueComputed": "(select b.id from DBO.account b where b.discord_id = 256536949756657664)"
                  }
                }
              ],
              "tableName": "twitch_so_account"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "20",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_2_rotation_notification",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "account_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "mode",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "rule",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "included_stages",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "excluded_stages",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_monday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_monday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_monday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_tuesday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_tuesday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_tuesday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_wednesday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_wednesday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_wednesday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_thursday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_thursday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_thursday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_friday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_friday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_friday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_saturday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_saturday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_saturday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "notify_sunday",
                    "type": "boolean"
                  }
                },
                {
                  "column": {
                    "name": "start_time_sunday",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "end_time_sunday",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "account_id",
              "baseTableName": "splatoon_2_rotation_notification",
              "constraintName": "fk_splatoon_2_rotation_notification_account_id",
              "onDelete": "RESTRICT",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "id",
              "referencedTableName": "account",
              "validate": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "21",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "slots",
                    "type": "int",
                    "valueComputed": "7"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_notification"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "22",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "splatoon_2_salmon_run_rotation_notification",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "account_id",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "stages",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "included_weapons",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "excluded_weapons",
                    "type": "bigint"
                  }
                },
                {
                  "column": {
                    "name": "days",
                    "type": "int"
                  }
                },
                {
                  "column": {
                    "name": "includedRandom",
                    "type": "int"
                  }
                }
              ]
            }
          },
          {
            "addForeignKeyConstraint": {
              "baseColumnNames": "account_id",
              "baseTableName": "splatoon_2_salmon_run_rotation_notification",
              "constraintName": "fk_splatoon_2_salmon_run_rotation_notification_account_id",
              "onDelete": "RESTRICT",
              "onUpdate": "RESTRICT",
              "referencedColumnNames": "id",
              "referencedTableName": "account",
              "validate": true
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "23",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "current_flag",
                    "type": "double"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "current_flag",
                    "type": "double"
                  }
                },
                {
                  "column": {
                    "name": "max_flag",
                    "type": "double"
                  }
                }
              ],
              "tableName": "splatoon_2_weapon_stats"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "24",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_match"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_match",
              "where": "kind='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_match",
              "where": "kind='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_match",
              "where": "kind='2'"
            }
          },
          {
            "dropColumn": {
              "columnName": "kind",
              "tableName": "splatoon_2_ability_match"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "kind",
              "oldColumnName": "kind_as_integer",
              "tableName": "splatoon_2_ability_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "gear_as_integer",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_notification"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "gear_as_integer",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_notification",
              "where": "gear='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "gear_as_integer",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_notification",
              "where": "gear='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "gear_as_integer",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_ability_notification",
              "where": "gear='2'"
            }
          },
          {
            "dropColumn": {
              "columnName": "gear",
              "tableName": "splatoon_2_ability_notification"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "gear",
              "oldColumnName": "gear_as_integer",
              "tableName": "splatoon_2_ability_notification"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_gear"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_gear",
              "where": "kind='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_gear",
              "where": "kind='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "kind_as_integer",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_gear",
              "where": "kind='2'"
            }
          },
          {
            "dropColumn": {
              "columnName": "kind",
              "tableName": "splatoon_2_gear"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "kind",
              "oldColumnName": "kind_as_integer",
              "tableName": "splatoon_2_gear"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "match_result_as_int",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "match_result_as_int",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "match_result='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "match_result_as_int",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "match_result='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "match_result_as_int",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "match_result='2'"
            }
          },
          {
            "dropColumn": {
              "columnName": "match_result",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "match_result",
              "oldColumnName": "match_result_as_int",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "mode='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "mode='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "mode='2'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "3"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "mode='3'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "4"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "mode='4'"
            }
          },
          {
            "dropColumn": {
              "columnName": "mode",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "mode",
              "oldColumnName": "mode_as_int",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_match"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='2'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "3"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='3'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "4"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='4'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "5"
                  }
                }
              ],
              "tableName": "splatoon_2_match",
              "where": "rule='5'"
            }
          },
          {
            "dropColumn": {
              "columnName": "rule",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "rule",
              "oldColumnName": "rule_as_int",
              "tableName": "splatoon_2_match"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "mode='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "mode='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "mode='2'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "3"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "mode='3'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "mode_as_int",
                    "valueComputed": "4"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "mode='4'"
            }
          },
          {
            "dropColumn": {
              "columnName": "mode",
              "tableName": "splatoon_2_rotation"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "mode",
              "oldColumnName": "mode_as_int",
              "tableName": "splatoon_2_rotation"
            }
          },
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "type": "int"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "0"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='0'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "1"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='1'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "2"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='2'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "3"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='3'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "4"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='4'"
            }
          },
          {
            "update": {
              "columns": [
                {
                  "column": {
                    "name": "rule_as_int",
                    "valueComputed": "5"
                  }
                }
              ],
              "tableName": "splatoon_2_rotation",
              "where": "rule='5'"
            }
          },
          {
            "dropColumn": {
              "columnName": "rule",
              "tableName": "splatoon_2_rotation"
            }
          },
          {
            "renameColumn": {
              "newColumnName": "rule",
              "oldColumnName": "rule_as_int",
              "tableName": "splatoon_2_rotation"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "25",
        "author": "strohkoenig",
        "preConditions": [
          {
            "onFail": "MARK_RAN",
            "columnExists": {
              "columnName": "send_daily_stats",
              "tableName": "account"
            }
          }
        ],
        "changes": [
          {
            "dropColumn": {
              "tableName": "account",
              "columnName": "send_daily_stats"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "26",
        "author": "strohkoenig",
        "changes": [
          {
            "delete": {
              "tableName": "splatoon_2_monthly_result",
              "where": "account_id IS NULL"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "27",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "splatoon_nickname",
                    "position": 5,
                    "type": "varchar(50)"
                  }
                },
                {
                  "column": {
                    "name": "splatoon_session_token",
                    "position": 6,
                    "type": "varchar(500)"
                  }
                },
                {
                  "column": {
                    "name": "rate_limit_number",
                    "type": "int",
                    "defaultValueComputed": "0"
                  }
                }
              ],
              "tableName": "account"
            }
          },
          {
            "dropColumn": {
              "columnName": "current_step",
              "tableName": "account"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "28-add-splatoon3-fields",
        "author": "strohkoenig",
        "changes": [
          {
            "addColumn": {
              "columns": [
                {
                  "column": {
                    "name": "g_token_splatoon3",
                    "position": 5,
                    "type": "varchar(1200)"
                  }
                },
                {
                  "column": {
                    "name": "bullet_token_splatoon3",
                    "position": 5,
                    "type": "varchar(180)"
                  }
                },
                {
                  "column": {
                    "name": "enable_splatoon3",
                    "type": "boolean",
                    "defaultValueComputed": "false"
                  }
                }
              ],
              "tableName": "account"
            }
          }
        ]
      }
    },
    {
      "changeSet": {
        "id": "29-add-going-live-notifications",
        "author": "strohkoenig",
        "changes": [
          {
            "createTable": {
              "tableName": "twitch_going_live_alert",
              "columns": [
                {
                  "column": {
                    "name": "id",
                    "type": "bigint",
                    "autoIncrement": true,
                    "constraints": {
                      "primaryKey": true,
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "twitch_channel_name",
                    "type": "varchar(30)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "guild_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "channel_id",
                    "type": "bigint",
                    "constraints": {
                      "nullable": false
                    }
                  }
                },
                {
                  "column": {
                    "name": "notification_message",
                    "type": "varchar(1800)",
                    "constraints": {
                      "nullable": false
                    }
                  }
                }
              ]
            }
          }
        ]
      }
    },
    {
      "includeAll": {
        "path": "/2023-12-12",
        "relativeToChangelogFile": true
      }
    },
    {
      "includeAll": {
        "path": "/2024-02-03",
        "relativeToChangelogFile": true
      }
    },
    {
      "includeAll": {
        "path": "/2024-02-16",
        "relativeToChangelogFile": true
      }
    }
  ]
}
